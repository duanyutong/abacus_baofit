// This is the D12 wavelet, sampled to 64.

// wavesample[] is the original sampling vector, in x order.
// wave[] is the same thing, but transposed so that a given fractional point 
// has the integer offsets contiguous in memory.  In this way, a particular 
// galaxy has the relevant information in 8 continuous elements.

#define WAVESAMPLE 64
#define WMIN (-1)
#define WMAX 6    // We'll add to cells from WMIN to WMAX, inclusive
#define WCELLS (WMAX-WMIN+1)

Float wave[WCELLS*WAVESAMPLE];
Float wavesample[WCELLS*WAVESAMPLE] = { \
  0.00000000000000,   0.00000000000000,   0.00000000000000,   0.00000000000000, \
  0.00000000000000,   0.00000000000000,   0.00000000000000,   0.00000000000000, \
  0.00000673118513,   0.00004267211987,   0.00012611324028,   0.00027051898254, \
  0.00049409302299,   0.00079949496212,   0.00119754820278,   0.00171493258764, \
  0.00236105246961,   0.00313215569452,   0.00403310910835,   0.00506802870764, \
  0.00624326603783,   0.00759123633646,   0.00913252053245,   0.01087097589526, \
  0.01281911276818,   0.01496710535125,   0.01730882489117,   0.01985581169693, \
  0.02260646439953,   0.02556778669408,   0.02874534009114,   0.03212932329039, \
  0.03572906148698,   0.03958055084925,   0.04370715785134,   0.04812696275442, \
  0.05286168663508,   0.05789912175562,   0.06324228989463,   0.06892078495970, \
  0.07493452053497,   0.08127087050220,   0.08792619635888,   0.09488751884738, \
  0.10214774246374,   0.10973208087128,   0.11764700979816,   0.12587809555144, \
  0.13443250128340,   0.14331609281821,   0.15253061923953,   0.16208945860137, \
  0.17199594493119,   0.18223281764309,   0.19279470588756,   0.20368487277888, \
  0.21490807634149,   0.22650438322803,   0.23850442856019,   0.25091967954323, \
  0.26377693466984,   0.27707934043023,   0.29083920066561,   0.30509693487024, \
  0.31988384402036,   0.33513191337641,   0.35085933988935,   0.36706119690585, \
  0.38373296068387,   0.40092316001465,   0.41865589311468,   0.43691786569973, \
  0.45569058678101,   0.47485556776803,   0.49431388406685,   0.51401863686433, \
  0.53387827888208,   0.55386927847704,   0.57393643504219,   0.59393778655530, \
  0.61382796378256,   0.63366187690338,   0.65343742651120,   0.67314169410805, \
  0.69276117132643,   0.71212060054094,   0.73111522442669,   0.74975252534479, \
  0.76797237377565,   0.78582363151914,   0.80334376756056,   0.82046957513920, \
  0.83721175013236,   0.85355859726026,   0.86949363964017,   0.88506797390441, \
  0.90024453160358,   0.91483890544662,   0.92873284318001,   0.94184685797566, \
  0.95407412236563,   0.96547933310428,   0.97605260251669,   0.98564428675443, \
  0.99426625883185,   1.00201882103160,   1.00894820377568,   1.01514034849668, \
  1.02065857169094,   1.02537842582973,   1.02928188379821,   1.03248024033836, \
  1.03495092990394,   1.03666230110225,   1.03761440572568,   1.03774490294561, \
  1.03704614897055,   1.03564849242198,   1.03360606714704,   1.03090796569903, \
  1.02754816490653,   1.02331626353183,   1.01805333964358,   1.01171925993983, \
  1.00417997015293,   0.99542794548858,   0.98540928069739,   0.97391154835221, \
  0.96097042519280,   0.94659902047294,   0.93092459773883,   0.91398166764427, \
  0.89581152249183,   0.87618273488381,   0.85498848655035,   0.83231981851353, \
  0.80817950743538,   0.78281568655960,   0.75644873808854,   0.72911553319566, \
  0.70100104757224,   0.67220345744477,   0.64284667719972,   0.61323144637108, \
  0.58345352427828,   0.55331650365976,   0.52277272258510,   0.49184376658725, \
  0.46051818235147,   0.42917575402956,   0.39803366949945,   0.36701715178380, \
  0.33624841387615,   0.30565684576211,   0.27517136308129,   0.24494178883081, \
  0.21495784612499,   0.18519269188335,   0.15566278759911,   0.12628541883334, \
  0.09712124820742,   0.06854483177995,   0.04079911926689,   0.01402114773654, \
 -0.01157571787597,  -0.03610405130512,  -0.05954119237694,  -0.08158430664538, \
 -0.10227511400030,  -0.12190549239127,  -0.14063670500932,  -0.15868052519624, \
 -0.17622872906907,  -0.19303514351809,  -0.20909523819179,  -0.22472811769073, \
 -0.23991542923469,  -0.25456734083450,  -0.26869159422832,  -0.28216693126410, \
 -0.29498879819575,  -0.30752916062081,  -0.31996065629947,  -0.33225980232954, \
 -0.34445204360676,  -0.35608159518391,  -0.36680486217563,  -0.37657888875973, \
 -0.38512547362888,  -0.39243666895575,  -0.39841296189966,  -0.40259247868757, \
 -0.40495845131287,  -0.40586926635939,  -0.40552868988744,  -0.40405568568910, \
 -0.40159493626832,  -0.39762298863328,  -0.39192068318088,  -0.38475944567097, \
 -0.37607602296349,  -0.36613185853305,  -0.35519591743558,  -0.34317374484787, \
 -0.33025056392351,  -0.31667078794520,  -0.30260052248409,  -0.28836201721197, \
 -0.27407646870572,  -0.25937925508470,  -0.24412163285288,  -0.22833908944388, \
 -0.21194888606799,  -0.19537341685586,  -0.17884313565647,  -0.16216690375209, \
 -0.14548165257084,  -0.12883149259110,  -0.11219860809277,  -0.09580095231914, \
 -0.07969116508513,  -0.06374522530475,  -0.04796513420718,  -0.03236653798600, \
 -0.01699676090936,  -0.00221510493539,   0.01172622317333,   0.02473807206964, \
  0.03661007060046,   0.04735668437448,   0.05691688549003,   0.06499504304846, \
  0.07163567930736,   0.07727875720921,   0.08219749405091,   0.08663196751469, \
  0.09087034025832,   0.09467762511984,   0.09809222902455,   0.10158665259737, \
  0.10517503097892,   0.10867599546436,   0.11207599391993,   0.11524329095666, \
  0.11816129186351,   0.12138112815509,   0.12516869956568,   0.12945890962252, \
  0.13432682771419,   0.13926450336077,   0.14387995223789,   0.14819004104946, \
  0.15189588900812,   0.15496547856222,   0.15729388126537,   0.15836080199122, \
  0.15814377329450,   0.15719491489067,   0.15579324619921,   0.15410437579033, \
  0.15235268835479,   0.14993606969456,   0.14662185867781,   0.14280027079298, \
  0.13836212537810,   0.13340624155912,   0.12809888477006,   0.12221618383206, \
  0.11582371758192,   0.10925132649050,   0.10263517036926,   0.09611474504237, \
  0.08978587912035,   0.08329078331790,   0.07644089778830,   0.06929151225789, \
  0.06172357860404,   0.05394484699215,   0.04606371888175,   0.03785825089826, \
  0.02941011498362,   0.02093296877551,   0.01252463037618,   0.00437596059708, \
 -0.00337811717938,  -0.01090706733043,  -0.01821283237978,  -0.02511504856260, \
 -0.03159841864369,  -0.03755480949358,  -0.04286965105817,  -0.04756768504066, \
 -0.05156580403959,  -0.05469114480291,  -0.05684072307743,  -0.05791030107776, \
 -0.05789964841211,  -0.05717325303008,  -0.05598312299894,  -0.05443471592949, \
 -0.05275930877217,  -0.05087760394478,  -0.04885189793212,  -0.04706673790398, \
 -0.04555842050154,  -0.04409525583723,  -0.04261534536130,  -0.04103597747706, \
 -0.03930924324274,  -0.03788719755924,  -0.03698720061992,  -0.03649620102293, \
 -0.03649510887713,  -0.03670231405149,  -0.03688123353492,  -0.03710818065538, \
 -0.03722226275512,  -0.03714815856248,  -0.03681505076063,  -0.03592466539817, \
 -0.03446024762641,  -0.03284047973004,  -0.03128333754704,  -0.02989161247784, \
 -0.02884173486467,  -0.02777632928673,  -0.02656680489291,  -0.02550773201995, \
 -0.02451901015025,  -0.02354127269063,  -0.02259742024473,  -0.02149280135944, \
 -0.02018769245413,  -0.01892445776498,  -0.01776616130301,  -0.01667081265509, \
 -0.01568217362741,  -0.01462524359044,  -0.01338292414479,  -0.01200981621649, \
 -0.01043025917433,  -0.00862291145616,  -0.00657682014380,  -0.00416687685304, \
 -0.00140828301525,   0.00147456109156,   0.00435113538791,   0.00713259997503, \
  0.00968961559646,   0.01212748424404,   0.01444037886141,   0.01642429123691, \
  0.01808003780791,   0.01949352308907,   0.02067758153864,   0.02170240408756, \
  0.02259039619194,   0.02312649312936,   0.02321951349386,   0.02291872059101, \
  0.02219209113382,   0.02119686452937,   0.02005946927674,   0.01875548375838, \
  0.01737817696860,   0.01596922363410,   0.01457350485590,   0.01335423458213, \
  0.01233944317951,   0.01135816866179,   0.01033872500990,   0.00925621095939, \
  0.00805753744508,   0.00693901267026,   0.00599116691226,   0.00511297544773, \
  0.00434610607796,   0.00364907305283,   0.00296525143110,   0.00236361659547, \
  0.00182103906582,   0.00126022054390,   0.00065030753463,  -0.00006392670261, \
 -0.00089463531568,  -0.00169161562343,  -0.00236885063327,  -0.00291236288176, \
 -0.00325700652686,  -0.00348001059837,  -0.00360653881910,  -0.00353056661894, \
 -0.00327498124663,  -0.00291746713037,  -0.00249036595442,  -0.00206609396367, \
 -0.00169207188531,  -0.00128187503828,  -0.00082405968612,  -0.00038950402574, \
  0.00003010873210,   0.00041623378029,   0.00074228909564,   0.00103807169146, \
  0.00128846050505,   0.00142117887329,   0.00140207044110,   0.00121084430025, \
  0.00083774289019,   0.00038141485750,  -0.00009224587891,  -0.00057320203180, \
 -0.00100668278203,  -0.00141306025147,  -0.00178395710588,  -0.00202594330046, \
 -0.00213881117940,  -0.00220510997176,  -0.00225932399938,  -0.00233650497343, \
 -0.00246882505479,  -0.00255280943795,  -0.00254915287473,  -0.00251321927779, \
 -0.00242404577590,  -0.00230468806821,  -0.00218360147257,  -0.00202247881279, \
 -0.00183258390243,  -0.00165880746918,  -0.00151783413565,  -0.00143432525325, \
 -0.00141891769559,  -0.00140781882915,  -0.00136635798330,  -0.00129591179080, \
 -0.00117154953699,  -0.00102636811029,  -0.00087390201632,  -0.00067152435215, \
 -0.00042799520723,  -0.00017090556417,   0.00009078519496,   0.00033069839613, \
  0.00053373888136,   0.00073515197562,   0.00094232198316,   0.00113388033491, \
  0.00131529174731,   0.00147551297285,   0.00160369424037,   0.00171242070825, \
  0.00179650612936,   0.00183736392537,   0.00182778855006,   0.00175978930363, \
  0.00163106358076,   0.00147043034743,   0.00129608346900,   0.00111176729640, \
  0.00093319120373,   0.00075356337403,   0.00057491265928,   0.00042342333641, \
  0.00030011395022,   0.00018694531929,   0.00007811190909,  -0.00003416769194, \
 -0.00015551358251,  -0.00025728846038,  -0.00032724798117,  -0.00037596761725, \
 -0.00039782270770,  -0.00040503476598,  -0.00040886732543,  -0.00040158188810, \
 -0.00038971120680,  -0.00038120719507,  -0.00038022249900,  -0.00039947741601, \
 -0.00044088837344,  -0.00048278676416,  -0.00051394995266,  -0.00053125460973, \
 -0.00052592882275,  -0.00051362681777,  -0.00050022306612,  -0.00047100835267, \
 -0.00042974161970,  -0.00038187978282,  -0.00032793398138,  -0.00027759867862, \
 -0.00023420963793,  -0.00018580052289,  -0.00012965721726,  -0.00007004222134, \
 -0.00000513791395,   0.00005785745427,   0.00011355367788,   0.00016495706892, \
  0.00020866776514,   0.00024127539993,   0.00026111942316,   0.00026280415645, \
  0.00024597265094,   0.00022059162611,   0.00019233864283,   0.00016377389099, \
  0.00014016460593,   0.00011669051767,   0.00009302051414,   0.00007790523977 \
};

void setup_wavelet() {
    // Do a transpose of the WCELLS by WAVESAMPLE matrix
    for (int k=0; k<WAVESAMPLE; k++) 
	for (int c=0; c<WCELLS; c++) 
	    wave[k*WCELLS+c] = wavesample[c*WAVESAMPLE+k];
    return;
}
